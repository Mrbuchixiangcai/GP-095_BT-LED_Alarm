C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE KEY_MODE
OBJECT MODULE PLACED IN .\Objects\Key_Mode.obj
COMPILER INVOKED BY: D:\ProgramFiles\Keil_v5\C51\BIN\C51.EXE App_User\Source\Key_Mode.c OPTIMIZE(8,SPEED) BROWSE INCDIR(
                    -.\Device;.\App_User\Include) DEBUG OBJECTEXTEND PRINT(.\Listings\Key_Mode.lst) OBJECT(.\Objects\Key_Mode.obj)

line level    source

   1          /*******************/
   2          /*Í·ÎÄ¼þheader file*/
   3          /*******************/
   4          #include "app_main.h"
*** ERROR C132 IN LINE 13 OF .\DEVICE\FUNC_DEF.H: '_UART_write': not in formal parameter list
*** ERROR C132 IN LINE 14 OF .\DEVICE\FUNC_DEF.H: 'UART_read': not in formal parameter list
*** ERROR C132 IN LINE 15 OF .\DEVICE\FUNC_DEF.H: 'WDT_init': not in formal parameter list
*** ERROR C132 IN LINE 16 OF .\DEVICE\FUNC_DEF.H: 'WDT_clear': not in formal parameter list
*** ERROR C132 IN LINE 17 OF .\DEVICE\FUNC_DEF.H: 'WT_init': not in formal parameter list
*** WARNING C329 IN LINE 16 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 17 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 20 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 21 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 24 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 25 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 28 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 29 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 32 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 33 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 36 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 37 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 40 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 41 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 44 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 45 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 48 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 49 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 52 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 53 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 56 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 57 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 60 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 2   

             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 61 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 64 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 65 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 68 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 69 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 72 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 73 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 76 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 77 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 80 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 81 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 84 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 85 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 88 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 89 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 92 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 93 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 96 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 97 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LE
             -D_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 100 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 101 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 104 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 105 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 108 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 109 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 112 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 113 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 116 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 117 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 120 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
             -ED_MODE.H: single-line comment contains line-continuation
*** WARNING C329 IN LINE 121 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\L
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 3   

             -ED_MODE.H: single-line comment contains line-continuation
*** ERROR C127 IN LINE 272 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LED
             -_MODE.H: 'LED_BRIGHTNESS_TypeDef': invalid storage class
*** ERROR C127 IN LINE 279 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LED
             -_MODE.H: 'ALARM_WORK_MODE_TypeDef': invalid storage class
*** ERROR C127 IN LINE 285 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LED
             -_MODE.H: 'ALARM_ONOFF_TypeDef': invalid storage class
*** ERROR C127 IN LINE 291 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LED
             -_MODE.H: 'ALARM_SNOOZE_TypeDef': invalid storage class
*** ERROR C127 IN LINE 297 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LED
             -_MODE.H: 'ALARM_RING_TIMER_TypeDef': invalid storage class
*** ERROR C127 IN LINE 303 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LED
             -_MODE.H: 'ALARM_RING_RUN_TypeDef': invalid storage class
*** ERROR C141 IN LINE 308 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LED
             -_MODE.H: syntax error near 'ALARM_ONOFF_TypeDef'
*** ERROR C129 IN LINE 308 OF \HOMEWORK\KEIL5\PROJECT\PROJECT.COMPANY\7¡¢GP-095\GP-095_BT-LED_ALARM\APP_USER\INCLUDE\LED
             -_MODE.H: missing ';' before 'Alarm_OnOff'
   5          
   6          /************************/
   7          /*ºê¶¨Òåmacro definition*/
   8          /************************/
   9          
  10          /*************************/
  11          /*ÀàÐÍ¶¨Òåbyte definition*/
  12          /*************************/
  13          FLAG_KEYSET_TypeDef  FlagKSet_TypeDef;//°´¼üµÄ¹¦ÄÜÉèÖÃ±êÖ¾
  14          TIME_TEMP_TypeDef    Time_Temp_TypeDef;//ÉèÖÃÊ±¼äÊ±²Å°ÑÉèÖÃµÄÊ±¼äÏÈ¸¶¸øÕâ¸ö£¬È»ºóÈ·ÈÏÁËÔÙ¸³Öµµ½gRTC_xx;
  15          
  16          /****************************/
  17          /*±êÖ¾Î»¶¨Òåflags definetion*/
  18          /****************************/
  19          
  20          /*****************************/
  21          /*±äÁ¿¶¨Òåvariable definition*/
  22          /*****************************/
  23          uint8_t  gbKeyPress;//°´¼ü°´ÏÂ
  24          uint8_t  gbKeyNone; //Ã»ÓÐ°´¼ü°´ÏÂ
  25          uint8_t  KeyValue;  //°´¼üÖµ
  26          uint8_t  KeyEvent;  //°´¼üÊÂ¼þ
  27          uint8_t  cntKeyLoop;//¼ÆÊý°´¼üÑ­»·£¬¶Ì°´£¬³¤°´£¬³¬³¤°´µÄ°´ÏÂÊ±¼ä
  28          uint8_t  cntKeylong;
  29          uint8_t  KeyCurValueBK;//ÏÖÔÚ°´¼ü±¸·Ý
  30          uint8_t  KeyCurValue;//°´¼üÏÖÔÚÖµ
  31          uint8_t  KeyLastValue;//°´¼üÉÏÒ»´ÎµÄÖµ
  32          
  33          /**************************/
  34          /*Êý×é¶¨Òåarray definition*/
  35          /**************************/
  36          
  37          /******************************/
  38          /*º¯ÊýÉùÃ÷Function declaration*/
  39          /******************************/
  40          
  41          /*****************************/
  42          /*º¯Êý¶¨Òåfunction definetion*/
  43          /*****************************/
  44          /*******************************************************************************
  45           * º¯ÊýÔ­ÐÍ£º
  46           * ÊäÈë²ÎÊý£º
  47           * Êä³ö²ÎÊý£º
  48           * º¯Êý¹¦ÄÜ£º
  49           * ·µ»ØÖµËµÃ÷£º
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 4   

  50           * ´´½¨ÈÕÆÚ£º
  51           * ´´½¨ÈË£º
  52           * ÐÞ¸ÄÈÕÆÚ
  53           * ÐÞ¸ÄÈË£º
  54           * µÚN´ÎÐÞ¸Ä£º
  55           * ÐÞ¸ÄÔ­Òò£º
  56           * ±¸×¢£º"P1=0x2F(0010_1111)"ÏÈ¸³Öµ¸øP1¿Ú£¬P15Îª1£¬P14Îª0£¬ÊäÈë¶Ë(P10-P13)Îª1£¬
  57           * È»ºóÔÙ¶ÁP1¿ÚµçÆ½(P1&0x0F)£¬²¢°Ñ¸ßËÄÎ»¶¼Çå0£¬¼ÙÈçÕâÊ±ºòP10±»°´ÏÂ£¬ÄÇ¶Áµ½µÄP1
  58           * ¿ÚµçÆ½Îª(P1&0x0f)Îª0x0E(0000_1110),È»ºóÓë0x0F(0000_1111)Òì»òµÃµ½0x01(0000_0001),
  59           * 
  60           *******************************************************************************/
  61          uint8_t  Matrix_Buttons(void)
  62          {
  63                  uint8_t  readData1,readData2;
  64                  uint8_t  keyValue;
  65                  keyValue=0;//Èç¹ûÃ»ÓÐ°´¼ü°´ÏÂ¾ÍÊÇ·µ»Ø0
  66                   
  67                  /*******************************************************************************
  68                  *¹¦ÄÜ£º"P1=0x2F(0010_1111)"ÏÈ¸³Öµ¸øP1¿Ú£¬P15Îª1£¬P14Îª0£¬ÊäÈë¶Ë(P10-P13)Îª1£¬È»
  69                  * ºóÔÙ¶ÁP1¿ÚµçÆ½(P1&0x0F)£¬²¢°Ñ¸ßËÄÎ»¶¼Çå0(P1&0x0F£¬¼ÙÈçÕâÊ±ºòP10±»°´ÏÂ£¬ÄÇ¶Áµ½
  70                  * µÄP1¿ÚµçÆ½Îª0x0E(0000_1110),È»ºóÓë0x0F(0000_1111)Òì»òµÃµ½0x01(0000_0001),
  71                  * readData1µÄ·¶Î§Îª1¡¢2¡¢4¡¢8£¬keyValueµÄ·¶Î§Îª1~9,9ÊÇ×éºÏ¼ü¡£
  72                  *******************************************************************************/
  73                  P1=0x2F;                        
  74                  readData1=(P1&0x0F)^0x0F;
  75                  switch(readData1)
  76                  {
  77                          case 1:
  78                                  keyValue=1; //K_SNOOZE_DIMMER
  79                                  break;
  80                          case 2:
  81                                  keyValue=2; //VOL+
  82                                  break;
  83                          case 4:
  84                                  keyValue=3; //K_PLAY_PAUSE
  85                                  break;
  86                          case 8:
  87                                  keyValue=4; //NEXT
  88                                  break;
  89                          default:
  90                                  break;
  91                  }
  92                  /*******************************************************************************
  93                  *¹¦ÄÜ£º"P1=0x1F(0001_1111)"ÏÈ¸³Öµ¸øP1¿Ú£¬P15Îª0£¬P14Îª1£¬ÊäÈë¶Ë(P10-P13)Îª1£¬È»
  94                  * ºóÔÙ¶ÁP1¿ÚµçÆ½(P1&0x0F)£¬²¢°Ñ¸ßËÄÎ»¶¼Çå0(P1&0x0F£¬¼ÙÈçÕâÊ±ºòP11±»°´ÏÂ£¬ÄÇ¶Áµ½
  95                  * µÄP1¿ÚµçÆ½Îª0x0D(0000_1101),È»ºóÓë0x0F(0000_1111)Òì»òµÃµ½0x02(0000_0010),
  96                  * readData2µÄ·¶Î§Îª1¡¢2¡¢4¡¢8£¬keyValueµÄ·¶Î§Îª1~9£¬9ÊÇ×éºÏ¼ü¡£
  97                  *******************************************************************************/
  98                  P1=0x1F;
  99                  readData2=(P1&0x0F)^0x0F;
 100                  switch(readData2)
 101                  {
 102                          case 1:
 103                                  keyValue=5; //ALARM
 104                                  if (keyValue == 1)//Îª1ËµÃ÷¸Õ²Åalarm¼ü±»°´ÏÂ£¬ÒòÎªÃ¿´Îµ÷ÓÃÕâ¸öº¯Êý¶¼»á³õÊ¼»¯
 105                                  {                                 //keyValue£¬ËùÒÔ²»»áÊÇÉÏ´Îµ÷ÓÃº¯ÊýÁôÏÂµÄÖµ
 106                                          keyValue = 9;  //K_AL_SNOOZE
 107                                  }
 108                                  else if (keyValue == 1)
 109                                          keyValue = 10; //K_AL_VOLINC,
 110                                  break;
 111                          case 2:
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 5   

 112                                  keyValue=6; //VOL-
 113                                  break;
 114                          case 4:
 115                                  keyValue=7; //BT
 116                                  break;
 117                          case 8:
 118                                  keyValue=8; //PREV
 119                                  break;
 120                          case 0x0C:
 121                                  keyValue = 11; //K_AL_VOLDEC,
 122                          default:
 123                                  break;
 124                  }
 125                   
 126                  return keyValue;
 127          }
 128          
 129          /*******************************************************************************
 130           * º¯ÊýÔ­ÐÍ£º
 131           * ÊäÈë²ÎÊý£º
 132           * Êä³ö²ÎÊý£º
 133           * º¯Êý¹¦ÄÜ£º
 134           * ·µ»ØÖµËµÃ÷£º
 135           * ´´½¨ÈÕÆÚ£º
 136           * ´´½¨ÈË£º
 137           * ÐÞ¸ÄÈÕÆÚ
 138           * ÐÞ¸ÄÈË£º
 139           * µÚN´ÎÐÞ¸Ä£º
 140           * ÐÞ¸ÄÔ­Òò£º
 141           * ±¸×¢£º
 142           *******************************************************************************/
 143          uint8_t GetKeyValue(void) 
 144          {
 145                  uint8_t  keyNum;
 146                  keyNum=Matrix_Buttons();
 147                  return keyNum; //·µ»Ø°´¼ü
 148          }
 149          
 150          /*******************************************************************************
 151           * º¯ÊýÔ­ÐÍ£º
 152           * ÊäÈë²ÎÊý£º
 153           * Êä³ö²ÎÊý£º
 154           * º¯Êý¹¦ÄÜ£º
 155           * ·µ»ØÖµËµÃ÷£º
 156           * ´´½¨ÈÕÆÚ£º
 157           * ´´½¨ÈË£º
 158           * ÐÞ¸ÄÈÕÆÚ
 159           * ÐÞ¸ÄÈË£º
 160           * µÚN´ÎÐÞ¸Ä£º
 161           * ÐÞ¸ÄÔ­Òò£º
 162           * ±¸×¢£º
 163           *******************************************************************************/
 164          void KeyEventPorc(uint8_t KeyTmp) //±»µ÷ÓÃÊ±½ÓÊÕµÄÊÇGetKeyValue()µÄ·µ»ØÖµ  Ò»°ã¹Ì¶¨£¬²»¸ü¸Ä
 165          {
 166                  gbKeyPress=0;
 167                  if(KeyCurValue!=KeyTmp) //Õâ¸öifÓï¾äÊÇÈ¥¶¶£¬»á±»Ö´ÐÐÁ½´Î£¬µÚÈý´Î½øÀ´Ê±Ö±½ÓÌø¹ý
 168                  {//KeyTmpÎªÁÙÊ±Öµ£¬
 169                          if(KeyCurValueBK!=KeyTmp)
 170                                  KeyCurValueBK=KeyTmp;
 171                          else //µÚ¶þ´Î½øÀ´Ê±Ö´ÐÐÕâÒ»Ìõ
 172                                  KeyCurValue=KeyTmp; //
 173                          return;
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 6   

 174                  }
 175                  if(KeyCurValue==KeyLastValue)
 176                  {
 177                          if((KeyLastValue==0) || (cntKeyLoop==0))
 178                                  return;
 179                          if(--cntKeyLoop==0) //Õâ¸öÔÚµÚ¶þ´Î½øKeyEventPorc()º¯Êý£¨µÚÒ»´Î½ø¡°if(KeyCurValue==KeyLastValue)¡±Ö®Ç°£©Ê
             -±±»ÏÂÃæ¸³ÖµÎª5
 180                          { //cntKeyLoopÎª5¾ÍÊÇ50msÊ±¼ä
 181                                  KeyValue=KeyLastValue; //·À¶¶Ö®ºó°ÑÈ·¶¨µÄ°´¼ü¸³Öµ¸øKeyValue
 182                                  if(gbKeyNone==0)
 183                                          gbKeyPress=1;
 184                                  switch(KeyEvent)
 185                                  {
 186                                          case 0:
 187                                                  KeyEvent=1;
 188                                                  KeyValue |= K_D;
 189                                                  cntKeyLoop=cKEY_HOLD;
 190                                                  break;
 191                                          case 1:
 192                                                  KeyEvent=2;
 193                                                  KeyValue |= K_H;
 194                                                  cntKeyLoop=cKEY_RATE_VOL;
 195                                                  break;
 196                                                  case 2:
 197                                          case 3:
 198                                                  KeyEvent=3;
 199                                                  KeyValue |= K_R;
 200                                                  cntKeyLoop=cKEY_RATE_VOL;
 201                                                  if(cntKeylong<250)
 202                                                          cntKeylong++;
 203                                                  break;
 204                                  }
 205                          }
 206                  }
 207                  else
 208                  {
 209                          if(KeyLastValue)
 210                          {
 211                                  KeyValue=KeyLastValue;
 212                                  if(gbKeyNone==0)
 213                                          gbKeyPress=1;
 214                                  switch(KeyEvent)
 215                                  {
 216                                          case 1:KeyValue |= K_U; break;
 217                                          case 2:KeyValue |= K_LU;break;
 218                                          case 3:KeyValue |= K_LU;break;
 219                                  }
 220                                  KeyEvent=0;
 221                          }
 222                          else
 223                          {
 224                                  gbKeyNone=0;
 225                                  cntKeylong=0;
 226                          }
 227                          cntKeyLoop=cKEY_CLICK;
 228                          KeyLastValue=KeyCurValue;
 229                  }
 230          }
 231          
 232          /*******************************************************************************
 233           * º¯ÊýÔ­ÐÍ£º
 234           * ÊäÈë²ÎÊý£º
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 7   

 235           * Êä³ö²ÎÊý£º
 236           * º¯Êý¹¦ÄÜ£º
 237           * ·µ»ØÖµËµÃ÷£º
 238           * ´´½¨ÈÕÆÚ£º
 239           * ´´½¨ÈË£º
 240           * ÐÞ¸ÄÈÕÆÚ
 241           * ÐÞ¸ÄÈË£º
 242           * µÚN´ÎÐÞ¸Ä£º
 243           * ÐÞ¸ÄÔ­Òò£º
 244           * ±¸×¢£º
 245           *******************************************************************************/
 246          void KeyScan(void) //±»Ö÷º¯Êýµ÷ÓÃ
 247          {
 248                  KeyEventPorc(GetKeyValue());
 249          }
 250           
 251           /*******************************************************************************
 252           * º¯ÊýÔ­ÐÍ£º
 253           * ÊäÈë²ÎÊý£º
 254           * Êä³ö²ÎÊý£º
 255           * º¯Êý¹¦ÄÜ£º
 256           * ·µ»ØÖµËµÃ÷£º
 257           * ´´½¨ÈÕÆÚ£º
 258           * ´´½¨ÈË£º
 259           * ÐÞ¸ÄÈÕÆÚ
 260           * ÐÞ¸ÄÈË£º
 261           * µÚN´ÎÐÞ¸Ä£º
 262           * ÐÞ¸ÄÔ­Òò£º
 263           * ±¸×¢£º2.¡¢³¤°´¡°TIME¡±¼ü2S£¬Ð¡Ê±×Ö·ûÉÁË¸£¬¶Ì°´¡°VOL-/PREV¡±¼ü£¬Ð¡Ê±µÝ¼õ£¬³¤°´
 264           * ¡°VOL-/PREV¡±¼ü£¬Ð¡Ê±¿ìËÙµÝ¼õ£»¶Ì°´¡°VOL+/NEXT¡±¼ü£¬Ð¡Ê±µÝÔö£¬³¤°´¡°VOL+/NEXT¡±¼ü£¬
 265           * Ð¡Ê±¿ìËÙµÝÔö¡£
 266           * 3¡¢¶Ì°´¡°TIME¡±¼ü£¬·Ö×Ö·ûÉÁË¸£¬¶Ì°´¡°VOL-/PREV¡±¼ü£¬·ÖÎ»ÊýµÝ¼õ£¬³¤°´¡°VOL-/PREV¡±¼ü£¬
 267           * ·ÖÎ»Êý¿ìËÙµÝ¼õ£»¶Ì°´¡°VOL+/NEXT¡±¼ü£¬·ÖÎ»ÊýµÝÔö£¬³¤°´¡°VOL+/NEXT¡±¼ü£¬·ÖÎ»Êý¿ìËÙµÝ
 268           * Ôö¡£
 269           * 4¡¢ÔÚ×ßÊ±Ä£Ê½ÏÂ£¬¶Ì°´¡°TIME/DIM¡±¼ü£¬µ÷ÕûÏÔÊ¾ÁÁ¶È£¬¿ÉÑ­»·µ÷Õû¸ß¡¢ÖÐ¡¢µÍÁÁ£¨Ä¬ÈÏ
 270           * Îª¸ßÁÁ£©
 271           *******************************************************************************/
 272          void KeyComMsg(void) 
 273          {
 274                  if(gbKeyPress)
 275                  { 
 276                          //Flag_data_bk=1;//Êý¾Ý¸Ä±äÊ±±¸·Ý
 277                          switch(KeyValue)
 278                          {
 279                                  case KU(K_SNOOZE_DIMMER)://¶Ì°´
 280                                  {//Alarm_Ring_Run
 281                                          if (Alarm1_TypeDef.Alarm_Ring_Run == ALARM_RING_RUN_ON)
 282                                          {
 283                                                  Alarm1_TypeDef.Alarm_Snooze = ALARM_SNOOZE_ON;//½øÈëÌ°Ë¯Ä£Ê½£¬Îª9·ÖÖÓ
 284                                          }
 285                                          else//Õý³£×ßÊ±Ä£Ê½ÏÂ£¬¶Ì°´SNOOZE¼ü£¬µ÷½ÚLEDÆ½ÁÁ¶È£¬¿ÉÑ­»·µ÷½Ú¸ß¡¢ÖÐ¡¢µÍÁÁ¶È(Ä¬ÈÏÎª¸ß)
 286                                          {
 287                                                  LED_Brightness_TypeDef--;
 288                                                  if (LED_Brightness_TypeDef == LED_TURN_OFF)//ÈýµµÑ­»·
 289                                                          LED_Brightness_TypeDef = LED_HIGH;
 290                                          }
 291                                          break;
 292                                  }
 293                                  case KH(K_SNOOZE_DIMMER)://³¤°´
 294                                  {
 295                                          
 296                                          break;
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 8   

 297                                  }
 298                                  case KU(K_VOLINC): //¶Ì°´//ÒôÁ¿¼Ó 
 299                                  case KR(K_VOLINC): //³¤°´//ÒôÁ¿¼Ó
 300                                  {
 301                                          //³¤°´¡°VOL+/NEXT¡±¼ü£¬Ð¡Ê±¿ìËÙµÝÔö¡£
 302                                          //³¤°´¡°VOL+/NEXT¡±¼ü£¬·ÖÖÓÎ»Êý¿ìËÙµÝÔö¡£
 303                                          if ((FlagKSet_TypeDef == FLAG_KEYSET_SETTIME_HOUR) && (PlayMode_TypeDef == PLAY_IN_TIME))
 304                                          {
 305                                                  if (Time_Temp_TypeDef.temp_RTC_Hour < 12)
 306                                                  {
 307                                                          Time_Temp_TypeDef.temp_RTC_Hour++;
 308                                                  }
 309                                          }
 310                                          else if ((FlagKSet_TypeDef == FLAG_KEYSET_SETTIME_MINUTE) && (PlayMode_TypeDef == PLAY_IN_TIME))
 311                                          {
 312                                                  if (Time_Temp_TypeDef.temp_RTC_Minute < 59)
 313                                                  {
 314                                                          Time_Temp_TypeDef.temp_RTC_Minute++;
 315                                                  }
 316                                                  timeCnt_30Sec = 0;//¿ªÆôÁË²»¶¯×÷30s×Ô¶¯±£´æ£¬ÕâÀï¶¯×÷ÁË£¬ËùÒÔÖØÐÂÖÃ0
 317                                          }
 318                                          else if ((FlagKSet_TypeDef == FLAG_KEYSET_SHORT_ALARM_HOUR) && (Alarm1_TypeDef.Alarm_OnOff == ALARM_ON
             -))
 319                                          {
 320                                                  if (Alarm1_TypeDef.tempHour < 12)
 321                                                  {
 322                                                          Alarm1_TypeDef.tempHour++;
 323                                                  }
 324                                          }
 325                                          else if ((FlagKSet_TypeDef == FLAG_KEYSET_SHORT_ALARM_MINUTE) && (Alarm1_TypeDef.Alarm_OnOff == ALARM_
             -ON))
 326                                          {
 327                                                  if (Alarm1_TypeDef.tempMinute < 59)
 328                                                  {
 329                                                          Alarm1_TypeDef.tempMinute++;
 330                                                  }
 331                                          }
 332                                          else if ((FlagKSet_TypeDef == FLAG_KEYSET_SHORT_ALARM_ALWORKMODE) && (Alarm1_TypeDef.Alarm_OnOff == AL
             -ARM_ON))
 333                                          {
 334                                                  if (Alarm1_TypeDef.AlarmWorkMode == ALARM_BEEP)
 335                                                  {
 336                                                          Alarm1_TypeDef.AlarmWorkMode = ALARM_BT;
 337                                                  }
 338                                                  else
 339                                                  {
 340                                                          Alarm1_TypeDef.AlarmWorkMode = ALARM_BEEP;
 341                                                  }
 342                                                  timeCnt_30Sec = 0;//¿ªÆôÁË²»¶¯×÷30s×Ô¶¯±£´æ£¬ÕâÀï¶¯×÷ÁË£¬ËùÒÔÖØÐÂÖÃ0
 343                                          }
 344                                          else//ÔÚÀ¶ÑÀ»òTF×´Ì¬ÏÂ£¬ÒôÁ¿¹¦ÄÜ
 345                                          {
 346                                                  if (sys_Volume < 15)
 347                                                  {
 348                                                          sys_Volume++;
 349                                                  }
 350                                          }
 351          
 352                                          break;
 353                                  }
 354                                  case KU(K_PLAY_PAUSE): //¶Ì°´//¶Ì°´·ÖÖÓ×Ö·ûÉÁË¸£¬
 355                                  {                                       
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 9   

 356                                          if (Music_Mode_TypeDef > MUSIC_OFF)//ÔÚÀ¶ÑÀºÍTF¿¨Ä£Ê½
 357                                          {
 358                                                  Ctrl_Com_TypeDef = CTRL_NEXT;
 359                                          }
 360                                          break;
 361                                  }
 362                                  case KR(K_PLAY_PAUSE): //¼ÆÊ±
 363                                  {
 364                                          
 365                                          break;
 366                                  }
 367                                  case KU(K_NEXT): //¶Ì°´
 368                                  case KR(K_NEXT): //³¤°´
 369                                  {
 370                                          
 371                                          break;
 372                                  }
 373                                  case KU(K_ALARM): //¶Ì°´//ÄÖÖÓ
 374                                  {
 375                                          /* ÉèÖÃRTCÊ±¼ä */
 376                                          if (FlagKSet_TypeDef == FLAG_KEYSET_SETTIME_HOUR)
 377                                          {
 378                                                  //ÔÚ³¤°´ALARM¼üºÍSNOOZE¼ü½øÈëÉèÖÃÊ±¼äÄ£Ê½-Ð¡Ê±ÉèÖÃ£¬ÔÚ¶Ì°´ALARM¼üÉèÖÃ·ÖÖÓÊ±¼ä
 379                                                  FlagKSet_TypeDef = FLAG_KEYSET_SETTIME_MINUTE;
 380                                                  Time_Temp_TypeDef.Flag_Confirm_30Sec=2;//¶Ì°´ALARM¼üÈ·ÈÏÉèÖÃ»ò²»¶¯×÷30s×Ô¶¯±£´æ£¬(Îª1ÊÇÈ·
 381                                                                                                                             //ÈÏÄÖÖÓÉèÖÃ±êÖ¾Î»),Îª2ÊÇ30s¼ÆÊ±±êÖ¾Î»£¬
 382                                                  timeCnt_30Sec = 0;//Ð£×¼£¬ÒÔ·ÀÒÔÇ°ÉèÖÃµÄÊ±¼ä»òÕßÆäËû¹¦ÄÜÊ¹ÓÃÊ±timeCnt_30SecÓÐ´óÓÚ0µÄÖµ
 383                                          }
 384                                          else if (FlagKSet_TypeDef == FLAG_KEYSET_SETTIME_MINUTE)
 385                                          {
 386                                                  //ÔÚ³¤°´ALARM¼üºÍSNOOZE¼ü½øÈëÉèÖÃÊ±¼äÄ£Ê½-Ð¡Ê±ÉèÖÃ£¬ÔÚ¶Ì°´ALARM¼üÉèÖÃ·ÖÖÓÊ±¼ä
 387                                                  //ÔÚ¶Ì°´ALRM¼üÈ·ÈÏÊ±¼äÉèÖÃ£¬»òÕßÔÚ½øÈë·ÖÖÓÉèÖÃÊ±¼äÖ®ºó²»¶¯×÷30s¼´×Ô¶¯±£´æ
 388                                                  FlagKSet_TypeDef = FLAG_KEYSET_OFF;
 389                                                  gRTC_Hour   = Time_Temp_TypeDef.temp_RTC_Hour;
 390                                                  gRTC_Minute = Time_Temp_TypeDef.temp_RTC_Minute;
 391                                                  //Time_Temp_TypeDef.Flag_Confirm_30Sec = 1;//¶Ì°´ALARM¼üÈ·ÈÏÉèÖÃ»ò²»¶¯×÷30s×Ô¶¯±£´æ£¬(Îª1ÊÇÈ·
 392                                                                                                                                   //ÈÏÄÖÖÓÉèÖÃ±êÖ¾Î»),Îª2ÊÇ30s¼ÆÊ±±êÖ¾Î»£¬
 393                                          }
 394          
 395                                          /* ÉèÖÃÄÖÖÓÊ±¼ä */
 396                                          if ((PlayMode_TypeDef == PLAY_IN_TIME) && (FlagKSet_TypeDef == FLAG_KEYSET_OFF))
 397                                          {
 398                                                  //Ö»ÓÐÔÚ×ßÊ±ºÍÃ»ÓÐÆäËûÉèÖÃÄ£Ê½ÏÂ(±ÈÈçÊ±¼äÉèÖÃ£¬ÒòÎª¶Ì°´ALARMÓÐÆäËû¹¦ÄÜ)£¬²Å»á½øÈë´Ëif¹¦ÄÜ
 399                                                  //ÉèÖÃÄÔÖÐÊ±¼ä²¢¿ªÆôÄÖÖÓ
 400                                                  FlagKSet_TypeDef = FLAG_KEYSET_SHORT_ALARM_HOUR;
 401                                                  Alarm1_TypeDef.Alarm_OnOff = ALARM_ON;
 402                                                  Alarm1_TypeDef.Flag_Confirm_30Sec = 2;//µÚ¶þ´Î¿ªÆôÄÖÖÓ£¬²¢ÇÒ²»ÐÞ¸ÄÄÔÖÐÊ±¼ä£¬²»¶¯×÷30s×Ô¶¯±£
 403                                                                                                                            //´æ£¬(Îª1ÊÇÈ·ÈÏÄÖÖÓÉèÖÃ±êÖ¾Î»)Îª2ÊÇ30s¼ÆÊ±±êÖ¾Î»£¬
 404                                          }
 405                                          else if ((FlagKSet_TypeDef == FLAG_KEYSET_SHORT_ALARM_HOUR) && (Alarm1_TypeDef.Alarm_OnOff == ALARM_ON
             -))  
 406                                          {
 407                                                  FlagKSet_TypeDef = FLAG_KEYSET_SHORT_ALARM_MINUTE;
 408                                                  Alarm1_TypeDef.Flag_Confirm_30Sec = 0;//µÚ¶þ´Î¿ªÆôÄÖÖÓ£¬²¢ÇÒÐÞ¸ÄÄÔÖÐÊ±¼ä£¬°Ñ²»¶¯×÷×Ô¶¯±£´æ¹Ø±Õ
 409                                                  //timeCnt_30Sec = 0;                                      //²¢Ð£×¼Ê±¼äÎª0
 410                                          }
 411                                          else if ((FlagKSet_TypeDef == FLAG_KEYSET_SHORT_ALARM_MINUTE) && (Alarm1_TypeDef.Alarm_OnOff == ALARM_
             -ON))
 412                                          {
 413                                                  FlagKSet_TypeDef = FLAG_KEYSET_SHORT_ALARM_ALWORKMODE;
 414                                                  Alarm1_TypeDef.Flag_Confirm_30Sec = 2;//¶Ì°´ALARM¼üÈ·ÈÏÉèÖÃ»ò²»¶¯×÷30s×Ô¶¯±£´æ£¬(Îª1
 415                                                                                                                            //ÊÇÈ·ÈÏÄÖÖÓÉèÖÃ±êÖ¾Î»)Îª2ÊÇ30s¼ÆÊ±±êÖ¾Î»£¬
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 10  

 416                                                  timeCnt_30Sec = 0;//Ð£×¼£¬ÒÔ·ÀÒÔÇ°ÉèÖÃµÄÊ±¼ä»òÕßÆäËû¹¦ÄÜÊ¹ÓÃÊ±timeCnt_30SecÓÐ´óÓÚ0µÄÖµ
 417                                          }
 418          
 419                                          break;
 420                                  }
 421                                  case KH(K_ALARM): //³¤°´//ÄÖÖÓ
 422                                  {
 423                                          
 424                                          break;
 425                                  }
 426                                  case KU(K_VOLDEC): //¶Ì°´//ÒôÁ¿¼õ
 427                                  case KR(K_VOLDEC): //³¤°´//ÒôÁ¿¼õ
 428                                  {
 429                                          //³¤°´¡°VOL-/PREV¡±¼ü£¬Ð¡Ê±¿ìËÙµÝ¼õ£»
 430                                          //³¤°´¡°VOL-/PREV¡±¼ü£¬·ÖÖÓÎ»Êý¿ìËÙµÝ¼õ£»
 431                                          if ((FlagKSet_TypeDef == FLAG_KEYSET_SETTIME_HOUR) && (PlayMode_TypeDef == PLAY_IN_TIME))
 432                                          {
 433                                                  if (Time_Temp_TypeDef.temp_RTC_Hour > 0)
 434                                                  {
 435                                                          Time_Temp_TypeDef.temp_RTC_Hour--;
 436                                                  }
 437                                          }
 438                                          else if ((FlagKSet_TypeDef == FLAG_KEYSET_SETTIME_MINUTE) && (PlayMode_TypeDef == PLAY_IN_TIME))
 439                                          {
 440                                                  if (Time_Temp_TypeDef.temp_RTC_Minute > 0)
 441                                                  {
 442                                                          Time_Temp_TypeDef.temp_RTC_Minute--;
 443                                                  }
 444                                                  timeCnt_30Sec = 0;//¿ªÆôÁË²»¶¯×÷30s×Ô¶¯±£´æ£¬ÕâÀï¶¯×÷ÁË£¬ËùÒÔÖØÐÂÖÃ0
 445                                          }
 446                                          else if ((FlagKSet_TypeDef == FLAG_KEYSET_SHORT_ALARM_HOUR) && (Alarm1_TypeDef.Alarm_OnOff == ALARM_ON
             -))
 447                                          {
 448                                                  if (Alarm1_TypeDef.tempHour > 0)
 449                                                  {
 450                                                          Alarm1_TypeDef.tempHour--;
 451                                                  }
 452                                          }
 453                                          else if ((FlagKSet_TypeDef == FLAG_KEYSET_SHORT_ALARM_MINUTE) && (Alarm1_TypeDef.Alarm_OnOff == ALARM_
             -ON))
 454                                          {
 455                                                  if (Alarm1_TypeDef.tempMinute > 0)
 456                                                  {
 457                                                          Alarm1_TypeDef.tempMinute--;
 458                                                  }
 459                                          }
 460                                          else if ((FlagKSet_TypeDef == FLAG_KEYSET_SHORT_ALARM_ALWORKMODE) && (Alarm1_TypeDef.Alarm_OnOff == AL
             -ARM_ON))
 461                                          {
 462                                                  if (Alarm1_TypeDef.AlarmWorkMode == ALARM_BEEP)
 463                                                  {
 464                                                          Alarm1_TypeDef.AlarmWorkMode = ALARM_BT;
 465                                                  }
 466                                                  else
 467                                                  {
 468                                                          Alarm1_TypeDef.AlarmWorkMode = ALARM_BEEP;
 469                                                  }
 470                                                  timeCnt_30Sec = 0;//¿ªÆôÁË²»¶¯×÷30s×Ô¶¯±£´æ£¬ÕâÀï¶¯×÷ÁË£¬ËùÒÔÖØÐÂÖÃ0
 471                                          }
 472                                          else//ÔÚÀ¶ÑÀ»òTF×´Ì¬ÏÂ£¬ÒôÁ¿¹¦ÄÜ
 473                                          {
 474                                                  if (sys_Volume > 0)
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 11  

 475                                                  {
 476                                                          sys_Volume--;
 477                                                  }
 478                                          }
 479          
 480                                          break;
 481                                  }
 482                                  case KU(K_BT): //¶Ì°´
 483                                  {
 484                                          //¶Ì°´¡°VOL-/PREV¡±¼ü£¬Ð¡Ê±µÝ¼õ£¬
 485                                          //¶Ì°´¡°VOL-/PREV¡±¼ü£¬·ÖÖÓÎ»ÊýµÝ¼õ£¬
 486                                          if (Music_Mode_TypeDef != MUSIC_BT)
 487                                          {
 488                                                  Music_Mode_TypeDef = MUSIC_BT;
 489                                          }
 490                                          break;
 491                                  }
 492                                  case KH(K_BT): //³¤°´
 493                                  {
 494                                          //³¤°´¡°VOL-/PREV¡±¼ü£¬Ð¡Ê±¿ìËÙµÝ¼õ£»
 495                                          //³¤°´¡°VOL-/PREV¡±¼ü£¬·ÖÖÓÎ»Êý¿ìËÙµÝ¼õ£»
 496                                          break;
 497                                  }
 498                                  case KU(K_PREV): //¶Ì°´
 499                                  case KR(K_PREV): //³¤°´
 500                                  {
 501                                          if (Music_Mode_TypeDef > MUSIC_OFF)//ÔÚÀ¶ÑÀºÍTF¿¨Ä£Ê½
 502                                          {
 503                                                  Ctrl_Com_TypeDef = CTRL_PREV;
 504                                          }
 505                                          break;
 506                                  }
 507                                  case KU(K_AL_SNOOZE): //¶Ì°´
 508                                  {
 509          
 510                                          break;
 511                                  }
 512                                  case KR(K_AL_SNOOZE): //³¤°´
 513                                  {
 514                                          if (PlayMode_TypeDef == PLAY_IN_TIME)
 515                                          {
 516                                                  if (cntKeylong == 10)//2s
 517                                                  {
 518                                                          //³¤°´ALARMºÍSNOOZE¼ü2s½øÈëÊ±¼äÉèÖÃÄ£Ê½-Ð¡ÊÂÉèÖÃ
 519                                                          FlagKSet_TypeDef = FLAG_KEYSET_SETTIME_HOUR;
 520                                                  }
 521                                          }
 522                                          break;
 523                                  }
 524                                  case KU(K_AL_VOLINC): //¶Ì°´
 525                                  case KR(K_AL_VOLINC): //³¤°´
 526                                  {
 527                                          if (PlayMode_TypeDef == PLAY_IN_TIME)
 528                                          {
 529                                                  if (cntKeylong == 10)//2s
 530                                                          gRTC_Hour = gRTC_Hour + 1;//×éºÏ¼ü-ÄÖÖÓºÍÒôÁ¿¼Ó-Í¬Ê±2s-RTCÊ±¼ä¼ÓÒ»Ð¡Ê±£¬±íÊ¾¿ªÆôÏÄÁîÊ±
 531                                          }
 532                                          break;
 533                                  }
 534                                  case KU(K_AL_VOLDEC): //¶Ì°´
 535                                  case KR(K_AL_VOLDEC): //³¤°´
 536                                  {
C51 COMPILER V9.00   KEY_MODE                                                              11/12/2018 10:19:34 PAGE 12  

 537                                          if (PlayMode_TypeDef == PLAY_IN_TIME)
 538                                          {
 539                                                  if (cntKeylong == 10)//2s
 540                                                          gRTC_Hour = gRTC_Hour - 1;//×éºÏ¼ü-ÄÖÖÓºÍÒôÁ¿¼õ-Í¬Ê±2s-RTCÊ±¼ä¼õÒ»Ð¡Ê±£¬±íÊ¾¹Ø±ÕÏÄÁîÊ±
 541                                          }
 542                                          break;
 543                                  }
 544                          }
 545                  }
 546          }
 547          
 548          
 549          
 550          
 551           
 552           /*******************************************************************************
 553           * º¯ÊýÔ­ÐÍ£º
 554           * ÊäÈë²ÎÊý£º
 555           * Êä³ö²ÎÊý£º
 556           * º¯Êý¹¦ÄÜ£º
 557           * ·µ»ØÖµËµÃ÷£º
 558           * ´´½¨ÈÕÆÚ£º
 559           * ´´½¨ÈË£º
 560           * ÐÞ¸ÄÈÕÆÚ
 561           * ÐÞ¸ÄÈË£º
 562           * µÚN´ÎÐÞ¸Ä£º
 563           * ÐÞ¸ÄÔ­Òò£º
 564           * ±¸×¢£º
 565           *******************************************************************************/
 566           
 567           
 568           /*******************************************************************************
 569           * º¯ÊýÔ­ÐÍ£º
 570           * ÊäÈë²ÎÊý£º
 571           * Êä³ö²ÎÊý£º
 572           * º¯Êý¹¦ÄÜ£º
 573           * ·µ»ØÖµËµÃ÷£º
 574           * ´´½¨ÈÕÆÚ£º
 575           * ´´½¨ÈË£º
 576           * ÐÞ¸ÄÈÕÆÚ
 577           * ÐÞ¸ÄÈË£º
 578           * µÚN´ÎÐÞ¸Ä£º
 579           * ÐÞ¸ÄÔ­Òò£º
 580           * ±¸×¢£º
 581           *******************************************************************************/
 582          
 583          
 584          
 585          
 586          
 587          
 588          
 589          
 590          
 591          
 592          
 593          
 594          
 595          
 596          

C51 COMPILATION COMPLETE.  54 WARNING(S),  13 ERROR(S)
